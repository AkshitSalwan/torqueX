<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= typeof title !== 'undefined' ? title : 'Error' %> | TorqueX</title>
  <link rel="stylesheet" href="/stylesheets/style.css">
  <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
  <!-- Clerk Authentication -->
  <script src="https://cdn.jsdelivr.net/npm/@clerk/clerk-js@latest/dist/clerk.browser.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Ensure we have a valid Clerk key - use this fallback key for development
      // In production, this would be passed from environment variables
      const publishableKey = 'pk_test_bW9kZXN0LWJlYWdsZS0zMC5jbGVyay5hY2NvdW50cy5kZXYk';
      console.log('Initializing Clerk with key:', publishableKey.substring(0, 10) + '...');
      
      try {
        if (window.Clerk) {
          window.Clerk.load({ 
            publishableKey: publishableKey
          }).then(function() {
            console.log('Clerk initialized successfully');
            document.dispatchEvent(new Event('clerkLoaded'));
          }).catch(function(error) {
            console.error('Error initializing Clerk:', error);
            // Fallback to traditional auth in case of Clerk error
            document.dispatchEvent(new Event('clerkFailed'));
          });
        } else {
          console.warn('Clerk object not available, using fallback authentication');
          document.dispatchEvent(new Event('clerkFailed'));
        }
      } catch (error) {
        console.error('Critical error initializing auth:', error);
        document.dispatchEvent(new Event('clerkFailed'));
      }
    });
  </script>
  <script src="/socket.io/socket.io.js"></script>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">
  <%- include('./navbar') %>
  
  <main class="flex-grow container mx-auto px-4 py-8">